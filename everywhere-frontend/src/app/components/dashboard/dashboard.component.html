<app-navbar></app-navbar>
<div class="container">
  <div class="dashboard-header">
    <div class="header-content">
      <h1>Dashboard Ejecutivo</h1>
      <p>Estad√≠sticas en tiempo real del sistema</p>
    </div>
    <button class="refresh-btn" (click)="refreshData()" [disabled]="isLoading">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z" stroke="currentColor" stroke-width="2"/>
        <path d="M12 7V12L15 15" stroke="currentColor" stroke-width="2"/>
      </svg>
      {{ isLoading ? 'Actualizando...' : 'Actualizar' }}
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Cargando estad√≠sticas...</p>
  </div>

  <!-- Main Statistics -->
  <div *ngIf="!isLoading && estadisticasGenerales" class="stats-section">
    <h2>Resumen General</h2>
    <div class="stats-grid">
      <div class="stat-card primary">
        <div class="stat-icon">üìã</div>
        <div class="stat-content">
          <div class="stat-value">{{ estadisticasGenerales.cotizacionesActivas }}</div>
          <div class="stat-label">Cotizaciones Activas</div>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-content">
          <div class="stat-value">{{ estadisticasGenerales.cotizacionesCompletadas }}</div>
          <div class="stat-label">Cotizaciones Completadas</div>
        </div>
      </div>

      <div class="stat-card warning">
        <div class="stat-icon">‚è≥</div>
        <div class="stat-content">
          <div class="stat-value">{{ estadisticasGenerales.liquidacionesPendientes }}</div>
          <div class="stat-label">Liquidaciones Pendientes</div>
        </div>
      </div>

      <div class="stat-card accent">
        <div class="stat-icon">üí∞</div>
        <div class="stat-content">
          <div class="stat-value">{{ formatCurrency(estadisticasGenerales.ventasMensual) }}</div>
          <div class="stat-label">Ventas del Mes</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div *ngIf="!isLoading" class="charts-section">
    <div class="charts-grid">
      <!-- Sales Chart -->
      <div class="chart-card">
        <h3>Ventas por Mes</h3>
        <div class="chart-container">
          <div class="bar-chart">
            <div *ngFor="let item of ventasPorMes" class="bar-item">
              <div class="bar" [style.height.%]="(item.ventas / 80000) * 100"></div>
              <div class="bar-label">{{ item.mes }}</div>
              <div class="bar-value">{{ formatCurrency(item.ventas) }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Status Pie Chart -->
      <div class="chart-card">
        <h3>Estado de Cotizaciones</h3>
        <div class="pie-chart">
          <div class="pie-legend">
            <div *ngFor="let estado of estadoCotizaciones" class="legend-item">
              <div class="legend-color" [style.background-color]="getStatusColor(estado.estado)"></div>
              <span>{{ estado.estado }}: {{ estado.cantidad }} ({{ estado.porcentaje }}%)</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Top Products -->
  <div *ngIf="!isLoading" class="products-section">
    <h2>Productos M√°s Vendidos</h2>
    <div class="products-table">
      <div class="table-header">
        <div>Producto</div>
        <div>Ventas</div>
        <div>Ingresos</div>
      </div>
      <div *ngFor="let producto of topProductos; let i = index" class="table-row">
        <div class="product-info">
          <span class="rank">#{{ i + 1 }}</span>
          <span class="name">{{ producto.nombre }}</span>
        </div>
        <div class="sales">{{ producto.ventas }}</div>
        <div class="revenue">{{ formatCurrency(producto.ingresos) }}</div>
      </div>
    </div>
  </div>

  <!-- Currency Revenue -->
  <div *ngIf="!isLoading" class="currency-section">
    <h2>Ingresos por Moneda</h2>
    <div class="currency-grid">
      <div *ngFor="let item of ingresosPorMoneda" class="currency-card">
        <div class="currency-code">{{ item.moneda }}</div>
        <div class="currency-amount">{{ formatCurrency(item.monto) }}</div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="actions-section">
    <h2>Acciones R√°pidas</h2>
    <div class="actions-grid">
      <a
        *ngFor="let action of quickActions"
        [routerLink]="action.route"
        class="action-card"
        [attr.data-color]="action.color"
      >
        <div class="action-icon">{{ action.icon }}</div>
        <h3>{{ action.title }}</h3>
        <p>{{ action.description }}</p>
      </a>
    </div>
  </div>
</div>
