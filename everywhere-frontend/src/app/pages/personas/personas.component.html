<app-navbar></app-navbar>
<div class="container">
  <div class="page-header">
    <h1>Gestión de Personas</h1>
    <p>Administra personas naturales, jurídicas y viajeros</p>
  </div>

   Search Section
  <div class="search-section">
    <div class="search-container">
      <input
        type="text"
        [(ngModel)]="searchQuery"
        (keyup.enter)="searchPersonas()"
        placeholder="Buscar por nombre, documento o RUC..."
        class="form-input search-input"
      />
      <button (click)="searchPersonas()" class="btn btn-primary">
        Buscar
      </button>
      <button (click)="toggleForm()" class="btn btn-secondary">
        {{ showForm ? 'Cancelar' : 'Nueva Persona' }}
      </button>
    </div>
  </div>

   Tabs
  <div class="tabs-container">
    <div class="tabs">
      <button
        [class]="'tab ' + (activeTab === 'natural' ? 'active' : '')"
        (click)="setActiveTab('natural')"
      >
        Personas Naturales
      </button>
      <button
        [class]="'tab ' + (activeTab === 'juridica' ? 'active' : '')"
        (click)="setActiveTab('juridica')"
      >
        Personas Jurídicas
      </button>
      <button
        [class]="'tab ' + (activeTab === 'viajero' ? 'active' : '')"
        (click)="setActiveTab('viajero')"
      >
        Viajeros
      </button>
    </div>
  </div>

   Form Section
  <div *ngIf="showForm" class="form-section">
    <div class="card">
      <h3>{{ editingId ? 'Editar' : 'Nueva' }} {{ activeTab === 'natural' ? 'Persona Natural' : activeTab === 'juridica' ? 'Persona Jurídica' : 'Viajero' }}</h3>

       Natural Person Form
      <form *ngIf="activeTab === 'natural'" [formGroup]="personaNaturalForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Nombre *</label>
            <input type="text" formControlName="nombre" class="form-input" />
            <div *ngIf="personaNaturalForm.get('nombre')?.invalid && personaNaturalForm.get('nombre')?.touched" class="error-message">
              El nombre es requerido (mínimo 2 caracteres)
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Apellido *</label>
            <input type="text" formControlName="apellido" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Tipo Documento *</label>
            <select formControlName="tipoDocumento" class="form-input">
              <option value="DNI">DNI</option>
              <option value="CE">Carnet de Extranjería</option>
              <option value="Pasaporte">Pasaporte</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Número Documento *</label>
            <input type="text" formControlName="numeroDocumento" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Teléfono</label>
            <input type="tel" formControlName="telefono" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" formControlName="email" class="form-input" />
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Dirección</label>
          <textarea formControlName="direccion" class="form-input" rows="2"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Fecha Nacimiento</label>
            <input type="date" formControlName="fechaNacimiento" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Nacionalidad</label>
            <input type="text" formControlName="nacionalidad" class="form-input" />
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" [disabled]="!personaNaturalForm.valid" class="btn btn-primary">
            {{ editingId ? 'Actualizar' : 'Guardar' }}
          </button>
          <button type="button" (click)="toggleForm()" class="btn btn-outline">
            Cancelar
          </button>
        </div>
      </form>

       Juridical Person Form
      <form *ngIf="activeTab === 'juridica'" [formGroup]="personaJuridicaForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">RUC *</label>
            <input type="text" formControlName="ruc" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Razón Social *</label>
            <input type="text" formControlName="razonSocial" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Representante Legal</label>
            <input type="text" formControlName="representanteLegal" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Tipo Empresa</label>
            <select formControlName="tipoEmpresa" class="form-input">
              <option value="">Seleccionar...</option>
              <option value="SAC">SAC</option>
              <option value="SRL">SRL</option>
              <option value="SA">SA</option>
              <option value="EIRL">EIRL</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Teléfono</label>
            <input type="tel" formControlName="telefono" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" formControlName="email" class="form-input" />
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Dirección</label>
          <textarea formControlName="direccion" class="form-input" rows="2"></textarea>
        </div>

        <div class="form-actions">
          <button type="submit" [disabled]="!personaJuridicaForm.valid" class="btn btn-primary">
            Guardar
          </button>
          <button type="button" (click)="toggleForm()" class="btn btn-outline">
            Cancelar
          </button>
        </div>
      </form>

       Traveler Form
      <form *ngIf="activeTab === 'viajero'" [formGroup]="viajeroForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Nombre *</label>
            <input type="text" formControlName="nombre" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Apellido *</label>
            <input type="text" formControlName="apellido" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Teléfono</label>
            <input type="tel" formControlName="telefono" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" formControlName="email" class="form-input" />
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Dirección</label>
          <textarea formControlName="direccion" class="form-input" rows="2"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Pasaporte</label>
            <input type="text" formControlName="pasaporte" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Fecha Vencimiento</label>
            <input type="date" formControlName="fechaVencimientoPasaporte" class="form-input" />
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">País Emisión Pasaporte</label>
          <input type="text" formControlName="paisEmisionPasaporte" class="form-input" />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Contacto Emergencia</label>
            <input type="text" formControlName="contactoEmergencia" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label">Teléfono Emergencia</label>
            <input type="tel" formControlName="telefonoEmergencia" class="form-input" />
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" [disabled]="!viajeroForm.valid" class="btn btn-primary">
            Guardar
          </button>
          <button type="button" (click)="toggleForm()" class="btn btn-outline">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

   Data Table
  <div class="table-section">
    <div class="card">
      <div *ngIf="loading" class="loading-message">
        Cargando datos...
      </div>

      <div *ngIf="!loading && currentData.length === 0" class="empty-message">
        No hay registros para mostrar
      </div>

      <table *ngIf="!loading && currentData.length > 0" class="table">
         Natural Person Table
        <thead *ngIf="activeTab === 'natural'">
          <tr>
            <th>Nombre</th>
            <th>Documento</th>
            <th>Teléfono</th>
            <th>Email</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody *ngIf="activeTab === 'natural'">
          <tr *ngFor="let persona of personasNaturales">
            <td>{{ persona.nombre }} {{ persona.apellido }}</td>
            <td>{{ persona.tipoDocumento }}: {{ persona.numeroDocumento }}</td>
            <td>{{ persona.telefono || '-' }}</td>
            <td>{{ persona.email || '-' }}</td>
            <td>
              <button (click)="editPersona(persona)" class="btn btn-sm btn-outline">
                Editar
              </button>
              <button (click)="deletePersona(persona.id!)" class="btn btn-sm btn-error">
                Eliminar
              </button>
            </td>
          </tr>
        </tbody>

         Juridical Person Table
        <thead *ngIf="activeTab === 'juridica'">
          <tr>
            <th>Razón Social</th>
            <th>RUC</th>
            <th>Representante</th>
            <th>Teléfono</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody *ngIf="activeTab === 'juridica'">
          <tr *ngFor="let persona of personasJuridicas">
            <td>{{ persona.razonSocial }}</td>
            <td>{{ persona.ruc }}</td>
            <td>{{ persona.representanteLegal || '-' }}</td>
            <td>{{ persona.telefono || '-' }}</td>
            <td>
              <button (click)="editPersona(persona)" class="btn btn-sm btn-outline">
                Editar
              </button>
              <button (click)="deletePersona(persona.id!)" class="btn btn-sm btn-error">
                Eliminar
              </button>
            </td>
          </tr>
        </tbody>

         Traveler Table
        <thead *ngIf="activeTab === 'viajero'">
          <tr>
            <th>Nombre</th>
            <th>Pasaporte</th>
            <th>Teléfono</th>
            <th>Contacto Emergencia</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody *ngIf="activeTab === 'viajero'">
          <tr *ngFor="let viajero of viajeros">
            <td>{{ viajero.nombre }} {{ viajero.apellido }}</td>
            <td>{{ viajero.pasaporte || '-' }}</td>
            <td>{{ viajero.telefono || '-' }}</td>
            <td>{{ viajero.contactoEmergencia || '-' }}</td>
            <td>
              <button (click)="editPersona(viajero)" class="btn btn-sm btn-outline">
                Editar
              </button>
              <button (click)="deletePersona(viajero.id!)" class="btn btn-sm btn-error">
                Eliminar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
